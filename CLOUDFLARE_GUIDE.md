# ‚òÅÔ∏è –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ Cloudflare Tunnel –∫ Dokploy

–≠—Ç–∞ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ–º–æ–∂–µ—Ç –≤–∞–º –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å **Cloudflare Tunnel**, —á—Ç–æ–±—ã –≤–∞—à —Å–µ—Ä–≤–µ—Ä (Dokploy –∏ –±–æ—Ç) –±—ã–ª –¥–æ—Å—Ç—É–ø–µ–Ω –∏–∑ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞ –ø–æ –∫—Ä–∞—Å–∏–≤–æ–º—É –¥–æ–º–µ–Ω—É (–Ω–∞–ø—Ä–∏–º–µ—Ä, `dokploy.yourdomain.com`), –¥–∞–∂–µ –µ—Å–ª–∏ —É –≤–∞—Å **–Ω–µ—Ç –±–µ–ª–æ–≥–æ IP**.

---

## üìã –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞

1.  **–ê–∫–∫–∞—É–Ω—Ç Cloudflare**: –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å –Ω–∞ [cloudflare.com](https://www.cloudflare.com/).
2.  **–î–æ–º–µ–Ω**: –£ –≤–∞—Å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∫—É–ø–ª–µ–Ω –¥–æ–º–µ–Ω, –∏ –µ–≥–æ DNS-—Å–µ—Ä–≤–µ—Ä—ã (NS) –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω—ã –Ω–∞ Cloudflare.
    *   *–ï—Å–ª–∏ –¥–æ–º–µ–Ω–∞ –Ω–µ—Ç, –º–æ–∂–Ω–æ –∫—É–ø–∏—Ç—å –µ–≥–æ –ø—Ä—è–º–æ –≤ Cloudflare –∏–ª–∏ —É –ª—é–±–æ–≥–æ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ (Reg.ru, Namecheap) –∏ –¥–µ–ª–µ–≥–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ Cloudflare.*

---

## üöÄ –®–∞–≥ 1: –°–æ–∑–¥–∞–Ω–∏–µ —Ç—É–Ω–Ω–µ–ª—è

1.  –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **Zero Trust Dashboard**: [one.dash.cloudflare.com](https://one.dash.cloudflare.com/).
2.  –í –º–µ–Ω—é —Å–ª–µ–≤–∞ –≤—ã–±–µ—Ä–∏—Ç–µ **Networks** -> **Tunnels**.
3.  –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É **Create a Tunnel**.
4.  –í—ã–±–µ—Ä–∏—Ç–µ **Cloudflared** –∏ –Ω–∞–∂–º–∏—Ç–µ **Next**.
5.  –ü—Ä–∏–¥—É–º–∞–π—Ç–µ –∏–º—è —Ç—É–Ω–Ω–µ–ª—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, `my-vps`) –∏ –Ω–∞–∂–º–∏—Ç–µ **Save Tunnel**.
6.  –í —Ä–∞–∑–¥–µ–ª–µ **Install and run a connector** –≤—ã–±–µ—Ä–∏—Ç–µ **Docker**.
7.  **–°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Ç–æ–∫–µ–Ω**. –≠—Ç–æ –¥–ª–∏–Ω–Ω–∞—è —Å—Ç—Ä–æ–∫–∞, –∫–æ—Ç–æ—Ä–∞—è –≤—ã–≥–ª—è–¥–∏—Ç –ø—Ä–∏–º–µ—Ä–Ω–æ —Ç–∞–∫:
    `eyJhIjoi...` (–æ–Ω–∞ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤–Ω—É—Ç—Ä–∏ –∫–æ–º–∞–Ω–¥—ã –ø–æ—Å–ª–µ —Ñ–ª–∞–≥–∞ `--token`).
    *–ù–∞–º –Ω—É–∂–µ–Ω –¢–û–õ–¨–ö–û —Å–∞–º —Ç–æ–∫–µ–Ω, –∞ –Ω–µ –≤—Å—è –∫–æ–º–∞–Ω–¥–∞.*

---

## üê≥ –®–∞–≥ 2: –ó–∞–ø—É—Å–∫ —Ç—É–Ω–Ω–µ–ª—è –≤ Dokploy

–ú—ã –∑–∞–ø—É—Å—Ç–∏–º `cloudflared` –∫–∞–∫ –æ—Ç–¥–µ–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≤ Dokploy.

1.  –ó–∞–π–¥–∏—Ç–µ –≤ –ø–∞–Ω–µ–ª—å **Dokploy**.
2.  –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –≤–∞—à –ø—Ä–æ–µ–∫—Ç.
3.  –ù–∞–∂–º–∏—Ç–µ **Create Service** -> **Compose**.
4.  –ù–∞–∑–æ–≤–∏—Ç–µ —Å–µ—Ä–≤–∏—Å, –Ω–∞–ø—Ä–∏–º–µ—Ä `cloudflare-tunnel`.
5.  –í —Ä–µ–¥–∞–∫—Ç–æ—Ä–µ `docker-compose.yml` –≤—Å—Ç–∞–≤—å—Ç–µ —Å–ª–µ–¥—É—é—â–∏–π –∫–æ–¥:

```yaml
version: '3.3'
services:
  tunnel:
    image: cloudflare/cloudflared:latest
    restart: always
    command: tunnel run
    environment:
      - TUNNEL_TOKEN=–í–°–¢–ê–í–¨–¢–ï_–í–ê–®_–¢–û–ö–ï–ù_–°–Æ–î–ê
```

6.  **–ó–∞–º–µ–Ω–∏—Ç–µ** `–í–°–¢–ê–í–¨–¢–ï_–í–ê–®_–¢–û–ö–ï–ù_–°–Æ–î–ê` –Ω–∞ —Ç–æ–∫–µ–Ω, –∫–æ—Ç–æ—Ä—ã–π –≤—ã —Å–∫–æ–ø–∏—Ä–æ–≤–∞–ª–∏ –Ω–∞ –®–∞–≥–µ 1.
7.  –ù–∞–∂–º–∏—Ç–µ **Deploy**.

–ï—Å–ª–∏ –≤—Å–µ –ø—Ä–æ—à–ª–æ —É—Å–ø–µ—à–Ω–æ, –≤ –ø–∞–Ω–µ–ª–∏ Cloudflare (–Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ —Ç—É–Ω–Ω–µ–ª—è) –≤–Ω–∏–∑—É –≤ —Ä–∞–∑–¥–µ–ª–µ **Connectors** —Å—Ç–∞—Ç—É—Å –∏–∑–º–µ–Ω–∏—Ç—Å—è –Ω–∞ **Connected** (–∑–µ–ª–µ–Ω—ã–π). –ù–∞–∂–º–∏—Ç–µ **Next**.

---

## üîó –®–∞–≥ 3: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–æ–º–µ–Ω–æ–≤ (Public Hostnames)

–¢–µ–ø–µ—Ä—å –Ω—É–∂–Ω–æ —Å–∫–∞–∑–∞—Ç—å Cloudflare, –∫–∞–∫–æ–π –¥–æ–º–µ–Ω –∫—É–¥–∞ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è—Ç—å.

### 1. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–ª—è Dokploy (–ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è)

1.  –ù–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Ç—É–Ω–Ω–µ–ª—è –ø–µ—Ä–µ–π–¥–∏—Ç–µ –≤–æ –≤–∫–ª–∞–¥–∫—É **Public Hostnames**.
2.  –ù–∞–∂–º–∏—Ç–µ **Add a public hostname**.
3.  **Subdomain**: –≤–≤–µ–¥–∏—Ç–µ –∂–µ–ª–∞–µ–º—ã–π –ø–æ–¥–¥–æ–º–µ–Ω (–Ω–∞–ø—Ä–∏–º–µ—Ä, `panel` –∏–ª–∏ `dokploy`).
4.  **Domain**: –≤—ã–±–µ—Ä–∏—Ç–µ –≤–∞—à –¥–æ–º–µ–Ω –∏–∑ —Å–ø–∏—Å–∫–∞.
5.  **Service**:
    *   **Type**: `HTTP`
    *   **URL**: `host.docker.internal:3000`
    *   *(–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ: Dokploy –æ–±—ã—á–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –ø–æ—Ä—Ç—É 3000. `host.docker.internal` –ø–æ–∑–≤–æ–ª—è–µ—Ç –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—É —Ç—É–Ω–Ω–µ–ª—è –æ–±—Ä–∞—â–∞—Ç—å—Å—è –∫ —Ö–æ—Å—Ç-–º–∞—à–∏–Ω–µ).*
6.  –ù–∞–∂–º–∏—Ç–µ **Save hostname**.

–¢–µ–ø–µ—Ä—å –≤–∞—à–∞ –ø–∞–Ω–µ–ª—å Dokploy –¥–æ—Å—Ç—É–ø–Ω–∞ –ø–æ –∞–¥—Ä–µ—Å—É `https://panel.yourdomain.com`! üîí

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–ª—è –ë–æ—Ç–∞ (–í–µ–±-—Å—Ç—Ä–∞–Ω–∏—Ü–∞ / Health Check)

–ï—Å–ª–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ, —á—Ç–æ–±—ã –ª–µ–Ω–¥–∏–Ω–≥ –±–æ—Ç–∞ —Ç–æ–∂–µ –±—ã–ª –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –¥–æ–º–µ–Ω—É:

1.  –°–Ω–æ–≤–∞ –Ω–∞–∂–º–∏—Ç–µ **Add a public hostname**.
2.  **Subdomain**: –Ω–∞–ø—Ä–∏–º–µ—Ä, `bot`.
3.  **Domain**: –≤–∞—à –¥–æ–º–µ–Ω.
4.  **Service**:
    *   **Type**: `HTTP`
    *   **URL**: `host.docker.internal:3001`
    *   *(–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ: –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø–æ—Ä—Ç —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å —Ç–µ–º, –∫–æ—Ç–æ—Ä—ã–π –≤—ã —É–∫–∞–∑–∞–ª–∏ –≤ `bot.py` –∏–ª–∏ `docker-compose.yml` –±–æ—Ç–∞. –í –Ω–∞—à–µ–º –∫–æ–¥–µ —ç—Ç–æ –ø–æ—Ä—Ç **3000**, –Ω–æ –µ—Å–ª–∏ –±–æ—Ç –∑–∞–ø—É—â–µ–Ω —á–µ—Ä–µ–∑ Dokploy –∫–∞–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ, Dokploy –Ω–∞–∑–Ω–∞—á–∞–µ—Ç –µ–º—É —Å–≤–æ–π –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –ø–æ—Ä—Ç. –õ—É—á—à–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π IP Docker —Å–µ—Ç–∏ –∏–ª–∏ –∏–º—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞, –µ—Å–ª–∏ –æ–Ω–∏ –≤ –æ–¥–Ω–æ–π —Å–µ—Ç–∏).*

**–í–∞–∂–Ω—ã–π –Ω—é–∞–Ω—Å –¥–ª—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π Dokploy:**
–ï—Å–ª–∏ –±–æ—Ç –∑–∞–ø—É—â–µ–Ω –∫–∞–∫ **Application** –≤ Dokploy, –æ–Ω –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ Docker-—Å–µ—Ç–∏.
–ü—Ä–æ—â–µ –≤—Å–µ–≥–æ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö **Service URL** —É–∫–∞–∑–∞—Ç—å:
*   **Type**: `HTTP`
*   **URL**: `–∏–º—è-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞-–±–æ—Ç–∞:3000` (–ò–º—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –º–æ–∂–Ω–æ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤ Dokploy –∏–ª–∏ –∫–æ–º–∞–Ω–¥–æ–π `docker ps`).

---

## ‚úÖ –ò—Ç–æ–≥

1.  –£ –≤–∞—Å –µ—Å—Ç—å –±–µ–∑–æ–ø–∞—Å–Ω—ã–π —Ç—É–Ω–Ω–µ–ª—å –±–µ–∑ –æ—Ç–∫—Ä—ã—Ç–∏—è –ø–æ—Ä—Ç–æ–≤.
2.  –£ –≤–∞—Å –µ—Å—Ç—å HTTPS (SSL) —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –æ—Ç Cloudflare –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.
3.  –í—ã –º–æ–∂–µ—Ç–µ –¥–æ–±–∞–≤–ª—è—Ç—å —Å–∫–æ–ª—å–∫–æ —É–≥–æ–¥–Ω–æ –ø–æ–¥–¥–æ–º–µ–Ω–æ–≤ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Å–µ—Ä–≤–∏—Å–æ–≤ (–±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö, –¥—Ä—É–≥–∏–µ –±–æ—Ç—ã, —Å–∞–π—Ç—ã) —á–µ—Ä–µ–∑ –º–µ–Ω—é **Public Hostnames**.
